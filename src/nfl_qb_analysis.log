2025-02-28 01:09:34,689 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:09:34,690 - __main__ - INFO - Starting data collection step
2025-02-28 01:09:34,690 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:09:34,691 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:09:34,691 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:09:48,790 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:09:48,791 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:09:51,198 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:09:51,198 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:09:54,970 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:09:54,971 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:09:57,031 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:09:57,032 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:09:58,800 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:09:58,800 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:09:58,800 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:09:58,800 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:10:04,103 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:10:04,116 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:10:04,267 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:10:04,272 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:10:04,341 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:10:04,341 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:10:04,342 - __main__ - INFO - Starting data processing step
2025-02-28 01:10:04,342 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:10:04,343 - src.data_processing.data_processor - ERROR - Error processing QB data: 'position'
2025-02-28 01:10:04,343 - __main__ - ERROR - Error in data processing: 'position'
2025-02-28 01:10:04,343 - __main__ - ERROR - Pipeline execution failed: 'position'
2025-02-28 01:12:14,088 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:12:14,088 - __main__ - INFO - Starting data collection step
2025-02-28 01:12:14,088 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:12:14,089 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:12:14,089 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:12:29,996 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:12:29,996 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:12:32,095 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:12:32,096 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:12:35,388 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:12:35,388 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:12:37,104 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:12:37,105 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:12:38,983 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:12:38,984 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:12:38,984 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:12:38,984 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:12:44,812 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:12:44,826 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:12:44,981 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:12:44,983 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:12:45,054 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:12:45,055 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:12:45,055 - __main__ - INFO - Starting data processing step
2025-02-28 01:12:45,056 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:12:45,057 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:12:45,058 - src.data_processing.data_processor - WARNING - player_id not found in both dataframes, checking for alternative keys
2025-02-28 01:12:45,058 - src.data_processing.data_processor - ERROR - Error processing QB data: Cannot find common identifier between player_stats and player_info
2025-02-28 01:12:45,058 - __main__ - ERROR - Error in data processing: Cannot find common identifier between player_stats and player_info
2025-02-28 01:12:45,058 - __main__ - ERROR - Pipeline execution failed: Cannot find common identifier between player_stats and player_info
2025-02-28 01:14:56,456 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:14:56,456 - __main__ - INFO - Starting data collection step
2025-02-28 01:14:56,457 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:14:56,457 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:14:56,457 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:15:16,035 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:15:16,036 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:15:18,012 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:15:18,013 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:15:21,579 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:15:21,579 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:15:23,426 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:15:23,427 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:15:25,337 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:15:25,337 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:15:25,338 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:15:25,338 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:15:31,623 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:15:31,638 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:15:31,814 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:15:31,816 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:15:31,900 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:15:31,901 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:15:31,901 - __main__ - INFO - Starting data processing step
2025-02-28 01:15:31,902 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:15:31,903 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:15:31,903 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:15:31,903 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:15:31,903 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:15:31,904 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:15:31,910 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:15:31,912 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:15:32,075 - src.data_processing.data_processor - ERROR - Error processing QB data: 'hurry'
2025-02-28 01:15:32,075 - __main__ - ERROR - Error in data processing: 'hurry'
2025-02-28 01:15:32,076 - __main__ - ERROR - Pipeline execution failed: 'hurry'
2025-02-28 01:16:06,780 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:16:06,780 - __main__ - INFO - Starting data collection step
2025-02-28 01:16:06,781 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:16:06,781 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:16:06,781 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:16:27,632 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:16:27,633 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:16:29,596 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:16:29,597 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:16:31,679 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:16:31,680 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:16:33,157 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:16:33,158 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:16:34,895 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:16:34,896 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:16:34,897 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:16:34,897 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:16:43,040 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:16:43,059 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:16:43,354 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:16:43,361 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:16:43,562 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:16:43,563 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:16:43,564 - __main__ - INFO - Starting data processing step
2025-02-28 01:16:43,564 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:16:43,565 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:16:43,567 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:16:43,567 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:16:43,568 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:16:43,568 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:16:43,587 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:16:43,596 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:16:43,890 - src.data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:16:43,891 - src.data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:16:43,892 - src.data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:16:43,893 - src.data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:16:43,893 - src.data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:16:44,894 - src.data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:16:44,897 - src.data_processing.data_processor - ERROR - Error processing QB data: "None of [Index(['team_abbr', 'wins', 'losses', 'ties', 'points_for', 'points_against'], dtype='object')] are in the [columns]"
2025-02-28 01:16:44,897 - __main__ - ERROR - Error in data processing: "None of [Index(['team_abbr', 'wins', 'losses', 'ties', 'points_for', 'points_against'], dtype='object')] are in the [columns]"
2025-02-28 01:16:44,898 - __main__ - ERROR - Pipeline execution failed: "None of [Index(['team_abbr', 'wins', 'losses', 'ties', 'points_for', 'points_against'], dtype='object')] are in the [columns]"
2025-02-28 01:18:58,322 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:18:58,322 - __main__ - INFO - Starting data collection step
2025-02-28 01:18:58,323 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:18:58,323 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:18:58,323 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:19:16,870 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:19:16,870 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:19:19,311 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:19:19,312 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:19:23,000 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:19:23,001 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:19:24,715 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:19:24,715 - src.data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:19:27,554 - src.data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:19:27,555 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:19:29,268 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:19:29,268 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:19:29,269 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:19:29,269 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:19:34,890 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:19:34,904 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:19:35,065 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:19:35,067 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:19:35,135 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:19:35,135 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:19:35,135 - __main__ - INFO - Starting data processing step
2025-02-28 01:19:35,136 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:19:35,136 - src.data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:19:35,137 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:19:35,137 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:19:35,137 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:19:35,137 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:19:35,138 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:19:35,142 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:19:35,144 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:19:35,263 - src.data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:19:35,264 - src.data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:19:35,264 - src.data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:19:35,265 - src.data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:19:35,265 - src.data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:19:35,721 - src.data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:19:35,723 - src.data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:19:35,724 - src.data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:19:35,724 - src.data_processing.data_processor - WARNING - No team identifier column found in QB stats, skipping team context enrichment
2025-02-28 01:19:35,727 - src.data_processing.data_processor - INFO - Handling 0 missing values across 90 columns
2025-02-28 01:19:35,741 - src.data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:19:35,741 - src.data_processing.data_processor - ERROR - Error processing QB data: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:19:35,742 - __main__ - ERROR - Error in data processing: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:19:35,742 - __main__ - ERROR - Pipeline execution failed: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:20:45,912 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:20:45,913 - __main__ - INFO - Starting data collection step
2025-02-28 01:20:45,913 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:20:45,913 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:20:45,914 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:21:04,390 - src.data_collection.data_fetcher - INFO - Successfully fetched 0 play-by-play records
2025-02-28 01:21:04,390 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:21:06,292 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:21:06,292 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:21:09,119 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:21:09,120 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:21:11,026 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:21:11,026 - src.data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:21:16,236 - src.data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:21:16,237 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:21:18,071 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:21:18,072 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:21:18,072 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:21:18,072 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:21:18,087 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:21:18,232 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:21:18,233 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:21:18,300 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:21:18,300 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:21:18,300 - __main__ - INFO - Starting data processing step
2025-02-28 01:21:18,301 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:21:18,302 - src.data_processing.data_processor - INFO - Processing QB data from: 0 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:21:18,302 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:21:18,302 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:21:18,302 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:21:18,303 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:21:18,303 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:21:18,308 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:21:18,310 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:21:18,310 - src.data_processing.data_processor - ERROR - Error processing QB data: 'play_type'
2025-02-28 01:21:18,310 - __main__ - ERROR - Error in data processing: 'play_type'
2025-02-28 01:21:18,311 - __main__ - ERROR - Pipeline execution failed: 'play_type'
2025-02-28 01:22:53,333 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:22:53,334 - __main__ - INFO - Starting data collection step
2025-02-28 01:22:53,334 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:22:53,334 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:22:53,335 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:24:26,968 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:24:26,969 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:24:28,965 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:24:28,966 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:24:38,101 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:24:38,101 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:24:39,772 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:24:39,772 - src.data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:24:42,638 - src.data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:24:42,639 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:24:44,329 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:24:44,330 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:24:44,330 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:24:44,330 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:24:51,309 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:24:51,326 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:24:51,525 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:24:51,528 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:24:51,619 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:24:51,620 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:24:51,620 - __main__ - INFO - Starting data processing step
2025-02-28 01:24:51,620 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:24:51,621 - src.data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:24:51,622 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:24:51,622 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:24:51,622 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:24:51,623 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:24:51,623 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:24:51,630 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:24:51,631 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:24:51,754 - src.data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:24:51,755 - src.data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:24:51,756 - src.data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:24:51,756 - src.data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:24:51,757 - src.data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:24:51,757 - src.data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:24:51,758 - src.data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:24:52,492 - src.data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:24:52,497 - src.data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:24:52,497 - src.data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:24:52,498 - src.data_processing.data_processor - WARNING - No team identifier column found in QB stats, skipping team context enrichment
2025-02-28 01:24:52,499 - src.data_processing.data_processor - INFO - Handling 0 missing values across 88 columns
2025-02-28 01:24:52,514 - src.data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:24:52,519 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:24:55,456 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:24:55,457 - src.data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:24:55,470 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:24:55,470 - __main__ - INFO - Starting metric development step
2025-02-28 01:24:55,471 - src.metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:24:55,478 - src.metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:24:55,482 - src.metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:24:55,487 - src.metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:24:55,489 - src.metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:24:55,494 - src.metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:24:55,496 - src.metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:24:55,499 - src.metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:24:55,499 - src.metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:24:55,503 - src.metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:24:55,503 - src.metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:24:55,504 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:24:55,504 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:24:55,504 - src.analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:24:55,506 - src.analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:24:59,609 - src.analysis.correlation_analysis - ERROR - Error running correlation analysis: Image data of dtype object cannot be converted to float
2025-02-28 01:24:59,610 - __main__ - ERROR - Error in correlation analysis: Image data of dtype object cannot be converted to float
2025-02-28 01:24:59,610 - __main__ - ERROR - Pipeline execution failed: Image data of dtype object cannot be converted to float
2025-02-28 01:26:04,163 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:26:04,164 - __main__ - INFO - Starting data collection step
2025-02-28 01:26:04,165 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:26:04,165 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:26:04,165 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:26:21,160 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:26:21,161 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:26:23,136 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:26:23,137 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:26:27,023 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:26:27,024 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:26:28,694 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:26:28,695 - src.data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:26:31,481 - src.data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:26:31,482 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:26:33,461 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:26:33,461 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:26:33,462 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:26:33,462 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:26:41,693 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:26:41,714 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:26:41,948 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:26:41,950 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:26:42,060 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:26:42,060 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:26:42,061 - __main__ - INFO - Starting data processing step
2025-02-28 01:26:42,062 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:26:42,063 - src.data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:26:42,063 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:26:42,064 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:26:42,064 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:26:42,064 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:26:42,065 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:26:42,071 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:26:42,074 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:26:42,215 - src.data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:26:42,216 - src.data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:26:42,217 - src.data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:26:42,218 - src.data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:26:42,218 - src.data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:26:42,219 - src.data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:26:42,219 - src.data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:26:43,075 - src.data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:26:43,080 - src.data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:26:43,081 - src.data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:26:43,081 - src.data_processing.data_processor - WARNING - No team identifier column found in QB stats, skipping team context enrichment
2025-02-28 01:26:43,083 - src.data_processing.data_processor - INFO - Handling 0 missing values across 88 columns
2025-02-28 01:26:43,101 - src.data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:26:43,107 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:26:46,758 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:26:46,759 - src.data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:26:46,779 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:26:46,780 - __main__ - INFO - Starting metric development step
2025-02-28 01:26:46,780 - src.metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:26:46,788 - src.metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:26:46,795 - src.metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:26:46,801 - src.metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:26:46,804 - src.metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:26:46,808 - src.metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:26:46,810 - src.metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:26:46,812 - src.metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:26:46,812 - src.metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:26:46,817 - src.metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:26:46,818 - src.metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:26:46,818 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:26:46,819 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:26:46,819 - src.analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:26:46,820 - src.analysis.correlation_analysis - ERROR - Error running correlation analysis: "['team_win_pct', 'wins', 'points_for'] not in index"
2025-02-28 01:26:46,820 - __main__ - ERROR - Error in correlation analysis: "['team_win_pct', 'wins', 'points_for'] not in index"
2025-02-28 01:26:46,821 - __main__ - ERROR - Pipeline execution failed: "['team_win_pct', 'wins', 'points_for'] not in index"
2025-02-28 01:27:21,200 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:27:21,201 - __main__ - INFO - Starting data collection step
2025-02-28 01:27:21,201 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:27:21,201 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:27:21,201 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:27:33,618 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:27:33,619 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:27:35,377 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:27:35,377 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:27:38,160 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:27:38,160 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:27:39,786 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:27:39,786 - src.data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:27:43,446 - src.data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:27:43,447 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:27:45,300 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:27:45,300 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:27:45,301 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:27:45,301 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:27:51,201 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:27:51,214 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:27:51,366 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:27:51,368 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:27:51,435 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:27:51,435 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:27:51,435 - __main__ - INFO - Starting data processing step
2025-02-28 01:27:51,436 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:27:51,436 - src.data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:27:51,437 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:27:51,437 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:27:51,437 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:27:51,437 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:27:51,438 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:27:51,441 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:27:51,443 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:27:51,570 - src.data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:27:51,572 - src.data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:27:51,572 - src.data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:27:51,573 - src.data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:27:51,574 - src.data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:27:51,574 - src.data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:27:51,575 - src.data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:27:52,171 - src.data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:27:52,174 - src.data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:27:52,175 - src.data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:27:52,175 - src.data_processing.data_processor - WARNING - No team identifier column found in QB stats, skipping team context enrichment
2025-02-28 01:27:52,176 - src.data_processing.data_processor - INFO - Handling 0 missing values across 88 columns
2025-02-28 01:27:52,186 - src.data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:27:52,190 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:27:55,510 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:27:55,511 - src.data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:27:55,524 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:27:55,525 - __main__ - INFO - Starting metric development step
2025-02-28 01:27:55,525 - src.metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:27:55,530 - src.metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:27:55,534 - src.metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:27:55,541 - src.metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:27:55,543 - src.metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:27:55,546 - src.metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:27:55,548 - src.metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:27:55,549 - src.metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:27:55,550 - src.metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:27:55,553 - src.metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:27:55,554 - src.metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:27:55,554 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:27:55,554 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:27:55,555 - src.analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:27:55,556 - src.analysis.correlation_analysis - ERROR - Error running correlation analysis: "['team_win_pct', 'wins', 'points_for'] not in index"
2025-02-28 01:27:55,556 - __main__ - ERROR - Error in correlation analysis: "['team_win_pct', 'wins', 'points_for'] not in index"
2025-02-28 01:27:55,557 - __main__ - ERROR - Pipeline execution failed: "['team_win_pct', 'wins', 'points_for'] not in index"
2025-02-28 01:28:43,622 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:28:43,623 - __main__ - INFO - Starting data collection step
2025-02-28 01:28:43,624 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:28:43,624 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:28:43,624 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:29:58,117 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:29:58,117 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:30:00,312 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:30:00,313 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:30:03,804 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:30:03,805 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:30:10,618 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:30:10,618 - __main__ - INFO - Starting data collection step
2025-02-28 01:30:10,619 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:30:10,619 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:30:10,619 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:30:36,539 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:30:36,540 - __main__ - INFO - Starting data collection step
2025-02-28 01:30:36,540 - src.data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:30:36,541 - src.data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:30:36,541 - src.data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:30:53,538 - src.data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:30:53,538 - src.data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:30:55,251 - src.data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:30:55,251 - src.data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:30:59,009 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:30:59,009 - src.data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:31:00,424 - src.data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:31:00,425 - src.data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:31:03,981 - src.data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:31:03,983 - src.data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:31:05,739 - src.data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:31:05,739 - src.data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:31:05,739 - src.data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: stat_type must be one of receiving, passing, rushing.
2025-02-28 01:31:05,740 - src.data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: stat_type must be one of receiving, passing, rushing., continuing without it
2025-02-28 01:31:11,535 - src.data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:31:11,550 - src.data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:31:11,714 - src.data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:31:11,716 - src.data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:31:11,791 - src.data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:31:11,792 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:31:11,792 - __main__ - INFO - Starting data processing step
2025-02-28 01:31:11,792 - src.data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:31:11,793 - src.data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:31:11,793 - src.data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:31:11,793 - src.data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:31:11,794 - src.data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:31:11,794 - src.data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:31:11,794 - src.data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:31:11,800 - src.data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:31:11,801 - src.data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:31:11,920 - src.data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:31:11,921 - src.data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:31:11,921 - src.data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:31:11,922 - src.data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:31:11,922 - src.data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:31:11,922 - src.data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:31:11,923 - src.data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:31:12,559 - src.data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:31:12,563 - src.data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:31:12,563 - src.data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:31:12,564 - src.data_processing.data_processor - WARNING - No team identifier column found in QB stats, skipping team context enrichment
2025-02-28 01:31:12,564 - src.data_processing.data_processor - INFO - Handling 0 missing values across 88 columns
2025-02-28 01:31:12,576 - src.data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:31:12,581 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:31:15,128 - src.data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:31:15,128 - src.data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:31:15,141 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:31:15,141 - __main__ - INFO - Starting metric development step
2025-02-28 01:31:15,142 - src.metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:31:15,147 - src.metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:31:15,152 - src.metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:31:15,157 - src.metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:31:15,158 - src.metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:31:15,162 - src.metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:31:15,164 - src.metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:31:15,165 - src.metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:31:15,165 - src.metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:31:15,171 - src.metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:31:15,171 - src.metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:31:15,172 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:31:15,172 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:31:15,172 - src.analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:31:15,172 - src.analysis.correlation_analysis - WARNING - Team metrics ['team_win_pct', 'wins', 'points_for'] not found in QB metrics data
2025-02-28 01:31:15,173 - src.analysis.correlation_analysis - INFO - Creating synthetic team metrics for demonstration purposes
2025-02-28 01:31:15,175 - src.analysis.correlation_analysis - INFO - Added synthetic team metrics to QB data
2025-02-28 01:31:15,175 - src.analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:31:15,176 - src.analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:31:15,178 - src.analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:31:15,179 - src.analysis.correlation_analysis - INFO - Rows after cleaning: 0 (dropped 48 rows with NaN values)
2025-02-28 01:31:15,187 - src.analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:31:15,357 - src.analysis.correlation_analysis - ERROR - Error running correlation analysis: Image data of dtype object cannot be converted to float
2025-02-28 01:31:15,358 - __main__ - ERROR - Error in correlation analysis: Image data of dtype object cannot be converted to float
2025-02-28 01:31:15,358 - __main__ - ERROR - Pipeline execution failed: Image data of dtype object cannot be converted to float
2025-02-28 01:40:20,166 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:40:20,166 - __main__ - INFO - Starting data collection step
2025-02-28 01:40:20,167 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:40:20,167 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:40:20,167 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:40:36,459 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:40:36,459 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:40:38,343 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:40:38,343 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:40:40,801 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:40:40,801 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:40:42,627 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:40:42,627 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:40:46,212 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:40:46,212 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:40:47,997 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:40:47,997 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:40:47,997 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:40:47,997 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:40:52,489 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:40:52,501 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:40:52,639 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:40:52,642 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:40:52,713 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:40:52,714 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:40:52,714 - __main__ - INFO - Starting data processing step
2025-02-28 01:40:52,714 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:40:52,715 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:40:52,716 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:40:52,716 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:40:52,716 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:40:52,716 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:40:52,716 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:40:52,728 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:40:52,729 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:40:52,837 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:40:52,838 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:40:52,838 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:40:52,838 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:40:52,839 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:40:52,839 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:40:52,847 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:40:52,847 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:40:53,361 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:40:53,365 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:40:53,366 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:40:53,366 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:40:53,367 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:40:53,367 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:40:53,370 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:40:53,371 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:40:53,380 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:40:53,384 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:40:55,474 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:40:55,474 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:40:55,485 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:40:55,485 - __main__ - INFO - Starting metric development step
2025-02-28 01:40:55,485 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:40:55,491 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:40:55,493 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:40:55,497 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:40:55,499 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:40:55,501 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:40:55,503 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:40:55,505 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:40:55,505 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:40:55,508 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:40:55,508 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:40:55,508 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:40:55,508 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:40:55,509 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:40:55,509 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:40:55,510 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:40:55,511 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:40:55,520 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:40:55,632 - analysis.correlation_analysis - ERROR - Error running correlation analysis: Image data of dtype object cannot be converted to float
2025-02-28 01:40:55,632 - __main__ - ERROR - Error in correlation analysis: Image data of dtype object cannot be converted to float
2025-02-28 01:40:55,633 - __main__ - ERROR - Pipeline execution failed: Image data of dtype object cannot be converted to float
2025-02-28 01:41:40,422 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:41:40,423 - __main__ - INFO - Starting data collection step
2025-02-28 01:41:40,423 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:41:40,423 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:41:40,424 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:41:51,313 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:41:51,313 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:41:53,085 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:41:53,085 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:41:55,361 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:41:55,361 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:41:56,895 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:41:56,895 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:42:00,571 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:42:00,572 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:42:02,317 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:42:02,318 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:42:02,318 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:42:02,318 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:42:07,049 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:42:07,061 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:42:07,200 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:42:07,202 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:42:07,268 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:42:07,269 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:42:07,269 - __main__ - INFO - Starting data processing step
2025-02-28 01:42:07,269 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:42:07,270 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:42:07,271 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:42:07,271 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:42:07,271 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:42:07,272 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:42:07,272 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:42:07,290 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:42:07,292 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:42:07,409 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:42:07,410 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:42:07,411 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:42:07,411 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:42:07,412 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:42:07,412 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:42:07,420 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:42:07,420 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:42:08,000 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:42:08,004 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:42:08,005 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:42:08,006 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:42:08,006 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:42:08,006 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:42:08,011 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:42:08,012 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:42:08,025 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:42:08,031 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:42:10,269 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:42:10,270 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:42:10,280 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:42:10,281 - __main__ - INFO - Starting metric development step
2025-02-28 01:42:10,281 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:42:10,286 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:42:10,290 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:42:10,294 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:42:10,295 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:42:10,298 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:42:10,299 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:42:10,300 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:42:10,300 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:42:10,304 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:42:10,304 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:42:10,304 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:42:10,304 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:42:10,304 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:42:10,304 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:42:10,305 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:42:10,307 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:42:10,316 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:42:10,515 - analysis.correlation_analysis - ERROR - Error running correlation analysis: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:42:10,516 - __main__ - ERROR - Error in correlation analysis: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:42:10,516 - __main__ - ERROR - Pipeline execution failed: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:42:54,768 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:42:54,768 - __main__ - INFO - Starting data collection step
2025-02-28 01:42:54,769 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:42:54,769 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:42:54,770 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:43:07,951 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:43:07,951 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:43:09,936 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:43:09,936 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:43:12,234 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:43:12,235 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:43:13,864 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:43:13,864 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:43:17,608 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:43:17,609 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:43:19,309 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:43:19,311 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:43:19,311 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:43:19,311 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:43:24,359 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:43:24,374 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:43:24,523 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:43:24,525 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:43:24,592 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:43:24,593 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:43:24,593 - __main__ - INFO - Starting data processing step
2025-02-28 01:43:24,593 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:43:24,594 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:43:24,596 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:43:24,596 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:43:24,596 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:43:24,597 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:43:24,597 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:43:24,610 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:43:24,611 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:43:24,713 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:43:24,714 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:43:24,714 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:43:24,715 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:43:24,715 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:43:24,715 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:43:24,725 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:43:24,726 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:43:25,299 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:43:25,303 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:43:25,304 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:43:25,304 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:43:25,304 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:43:25,308 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:43:25,311 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:43:25,312 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:43:25,323 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:43:25,326 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:43:27,600 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:43:27,600 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:43:27,611 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:43:27,611 - __main__ - INFO - Starting metric development step
2025-02-28 01:43:27,611 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:43:27,616 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:43:27,619 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:43:27,623 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:43:27,624 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:43:27,628 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:43:27,629 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:43:27,630 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:43:27,631 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:43:27,634 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:43:27,634 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:43:27,634 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:43:27,635 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:43:27,635 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:43:27,636 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 01:43:27,636 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:43:27,638 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:43:27,639 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:43:27,649 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:43:27,981 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 01:43:28,466 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 01:43:28,473 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 01:43:28,477 - analysis.correlation_analysis - ERROR - Error running correlation analysis: Missing optional dependency 'tabulate'.  Use pip or conda to install tabulate.
2025-02-28 01:43:28,477 - __main__ - ERROR - Error in correlation analysis: Missing optional dependency 'tabulate'.  Use pip or conda to install tabulate.
2025-02-28 01:43:28,478 - __main__ - ERROR - Pipeline execution failed: Missing optional dependency 'tabulate'.  Use pip or conda to install tabulate.
2025-02-28 01:43:43,772 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:43:43,773 - __main__ - INFO - Starting data collection step
2025-02-28 01:43:43,773 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:43:43,774 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:43:43,774 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:43:58,064 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:43:58,064 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:43:59,816 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:43:59,817 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:44:02,606 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:44:02,606 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:44:04,059 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:44:04,059 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:44:07,996 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:44:07,996 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:44:09,728 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:44:09,728 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:44:09,729 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:44:09,730 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:44:16,454 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:44:16,470 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:44:16,671 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:44:16,675 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:44:16,765 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:44:16,765 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:44:16,766 - __main__ - INFO - Starting data processing step
2025-02-28 01:44:16,766 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:44:16,767 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:44:16,768 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:44:16,768 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:44:16,768 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:44:16,768 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:44:16,769 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:44:16,786 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:44:16,788 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:44:16,918 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:44:16,919 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:44:16,920 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:44:16,920 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:44:16,920 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:44:16,921 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:44:16,931 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:44:16,932 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:44:17,608 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:44:17,612 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:44:17,613 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:44:17,614 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:44:17,614 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:44:17,614 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:44:17,618 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:44:17,620 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:44:17,632 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:44:17,637 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:44:20,543 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:44:20,543 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:44:20,554 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:44:20,555 - __main__ - INFO - Starting metric development step
2025-02-28 01:44:20,555 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:44:20,562 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:44:20,567 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:44:20,574 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:44:20,575 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:44:20,579 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:44:20,581 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:44:20,582 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:44:20,582 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:44:20,587 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:44:20,587 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:44:20,588 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:44:20,588 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:44:20,588 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:44:20,589 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 01:44:20,589 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:44:20,590 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:44:20,592 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:44:20,602 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:44:21,016 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 01:44:21,597 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 01:44:21,600 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 01:44:21,608 - analysis.correlation_analysis - ERROR - Error running correlation analysis: reduction operation 'argmax' not allowed for this dtype
2025-02-28 01:44:21,608 - __main__ - ERROR - Error in correlation analysis: reduction operation 'argmax' not allowed for this dtype
2025-02-28 01:44:21,608 - __main__ - ERROR - Pipeline execution failed: reduction operation 'argmax' not allowed for this dtype
2025-02-28 01:45:07,072 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:45:07,073 - __main__ - INFO - Starting data collection step
2025-02-28 01:45:07,073 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:45:07,073 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:45:07,073 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:45:22,675 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:45:22,675 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:45:24,816 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:45:24,816 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:45:28,433 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:45:28,434 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:45:30,237 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:45:30,237 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:45:33,942 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:45:33,942 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:45:35,696 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:45:35,697 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:45:35,697 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:45:35,697 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:45:43,266 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:45:43,283 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:45:43,505 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:45:43,507 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:45:43,603 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:45:43,604 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:45:43,604 - __main__ - INFO - Starting data processing step
2025-02-28 01:45:43,605 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:45:43,606 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:45:43,606 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:45:43,606 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:45:43,607 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:45:43,607 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:45:43,608 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:45:43,623 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:45:43,624 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:45:43,763 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:45:43,764 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:45:43,765 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:45:43,766 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:45:43,766 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:45:43,767 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:45:43,781 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:45:43,781 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:45:44,527 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:45:44,532 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:45:44,533 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:45:44,534 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:45:44,534 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:45:44,535 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:45:44,539 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:45:44,541 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:45:44,559 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:45:44,564 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:45:47,774 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:45:47,775 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:45:47,787 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:45:47,788 - __main__ - INFO - Starting metric development step
2025-02-28 01:45:47,788 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:45:47,796 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:45:47,801 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:45:47,806 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:45:47,808 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:45:47,812 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:45:47,814 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:45:47,816 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:45:47,816 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:45:47,820 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:45:47,821 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:45:47,821 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:45:47,822 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:45:47,822 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:45:47,822 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 01:45:47,823 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:45:47,824 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:45:47,826 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:45:47,837 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:45:48,314 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 01:45:48,979 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 01:45:48,982 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 01:45:48,988 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 01:45:48,989 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 01:45:48,989 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 01:45:48,989 - __main__ - INFO - Starting visualization step
2025-02-28 01:45:48,990 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 01:45:48,990 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 01:45:49,434 - visualization.visualizer - ERROR - Error creating visualizations: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:45:49,434 - __main__ - ERROR - Error in visualization: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:45:49,435 - __main__ - ERROR - Pipeline execution failed: expected str, bytes or os.PathLike object, not NoneType
2025-02-28 01:46:28,189 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:46:28,189 - __main__ - INFO - Starting data collection step
2025-02-28 01:46:28,190 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:46:28,190 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:46:28,191 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:46:39,902 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:46:39,902 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:46:41,790 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:46:41,791 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:46:45,067 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:46:45,068 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:46:46,755 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:46:46,756 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:46:50,721 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:46:50,721 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:46:52,416 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:46:52,416 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:46:52,417 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:46:52,417 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:47:00,513 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:47:00,531 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:47:00,752 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:47:00,755 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:47:00,854 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:47:00,855 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:47:00,855 - __main__ - INFO - Starting data processing step
2025-02-28 01:47:00,856 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:47:00,857 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:47:00,857 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:47:00,857 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:47:00,857 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:47:00,857 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:47:00,859 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:47:00,875 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:47:00,876 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:47:00,998 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:47:00,999 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:47:01,000 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:47:01,000 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:47:01,001 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:47:01,001 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:47:01,013 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:47:01,014 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:47:01,761 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:47:01,766 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:47:01,767 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:47:01,768 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:47:01,768 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:47:01,769 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:47:01,772 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:47:01,773 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:47:01,789 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:47:01,795 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:47:04,681 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:47:04,683 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:47:04,695 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:47:04,695 - __main__ - INFO - Starting metric development step
2025-02-28 01:47:04,696 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:47:04,701 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:47:04,705 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:47:04,710 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:47:04,711 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:47:04,715 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:47:04,717 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:47:04,718 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:47:04,718 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:47:04,722 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:47:04,723 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:47:04,723 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:47:04,723 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:47:04,723 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:47:04,724 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 01:47:04,724 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:47:04,725 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:47:04,727 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:47:04,737 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:47:05,130 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 01:47:05,663 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 01:47:05,667 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 01:47:05,672 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 01:47:05,673 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 01:47:05,673 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 01:47:05,673 - __main__ - INFO - Starting visualization step
2025-02-28 01:47:05,673 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 01:47:05,674 - visualization.visualizer - INFO - Created visualization directory: ./data\season_2023\visualizations
2025-02-28 01:47:05,674 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 01:47:06,854 - visualization.visualizer - INFO - Created metric correlation matrix and saved to ./data\season_2023\visualizations\metric_correlation_matrix.png
2025-02-28 01:47:07,242 - visualization.visualizer - INFO - Created distribution plot for qb_composite_score and saved to ./data\season_2023\visualizations\qb_composite_score_distribution.png
2025-02-28 01:47:07,580 - visualization.visualizer - INFO - Created distribution plot for passer_rating and saved to ./data\season_2023\visualizations\passer_rating_distribution.png
2025-02-28 01:47:07,986 - visualization.visualizer - INFO - Created distribution plot for depth_adjusted_comp_pct and saved to ./data\season_2023\visualizations\depth_adjusted_comp_pct_distribution.png
2025-02-28 01:47:08,327 - visualization.visualizer - INFO - Created distribution plot for pressure_performance and saved to ./data\season_2023\visualizations\pressure_performance_distribution.png
2025-02-28 01:47:08,327 - visualization.visualizer - WARNING - Required columns not found for metric vs wins scatter plots
2025-02-28 01:47:08,613 - visualization.visualizer - ERROR - Error creating visualizations: 'player_name'
2025-02-28 01:47:08,613 - __main__ - ERROR - Error in visualization: 'player_name'
2025-02-28 01:47:08,614 - __main__ - ERROR - Pipeline execution failed: 'player_name'
2025-02-28 01:47:38,877 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:47:38,877 - __main__ - INFO - Starting data collection step
2025-02-28 01:47:38,878 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:47:38,878 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:47:38,878 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:47:54,205 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:47:54,205 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:47:56,332 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:47:56,332 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:48:00,282 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:48:00,283 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:48:01,992 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:48:01,992 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:48:05,906 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:48:05,907 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:48:07,550 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:48:07,551 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:48:07,551 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:48:07,551 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:48:12,328 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:48:12,340 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:48:12,502 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:48:12,504 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:48:12,581 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:48:12,581 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:48:12,582 - __main__ - INFO - Starting data processing step
2025-02-28 01:48:12,582 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:48:12,583 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:48:12,583 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:48:12,584 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:48:12,584 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:48:12,585 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:48:12,585 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:48:12,602 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:48:12,604 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:48:12,748 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:48:12,749 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:48:12,749 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:48:12,749 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:48:12,750 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:48:12,750 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:48:12,760 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:48:12,760 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:48:13,433 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:48:13,437 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:48:13,439 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:48:13,439 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:48:13,439 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:48:13,440 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:48:13,442 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:48:13,443 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:48:13,454 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:48:13,457 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:48:15,665 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:48:15,666 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:48:15,676 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:48:15,677 - __main__ - INFO - Starting metric development step
2025-02-28 01:48:15,677 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:48:15,682 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:48:15,686 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:48:15,690 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:48:15,692 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:48:15,695 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:48:15,696 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:48:15,697 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:48:15,697 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:48:15,701 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:48:15,702 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:48:15,702 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:48:15,702 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:48:15,702 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:48:15,702 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 01:48:15,703 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:48:15,704 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:48:15,705 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:48:15,713 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:48:16,018 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 01:48:16,435 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 01:48:16,437 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 01:48:16,442 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 01:48:16,442 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 01:48:16,442 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 01:48:16,443 - __main__ - INFO - Starting visualization step
2025-02-28 01:48:16,443 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 01:48:16,443 - visualization.visualizer - INFO - Created visualization directory: ./data\season_2023\visualizations
2025-02-28 01:48:16,443 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 01:48:17,308 - visualization.visualizer - INFO - Created metric correlation matrix and saved to ./data\season_2023\visualizations\metric_correlation_matrix.png
2025-02-28 01:48:17,576 - visualization.visualizer - INFO - Created distribution plot for qb_composite_score and saved to ./data\season_2023\visualizations\qb_composite_score_distribution.png
2025-02-28 01:48:17,821 - visualization.visualizer - INFO - Created distribution plot for passer_rating and saved to ./data\season_2023\visualizations\passer_rating_distribution.png
2025-02-28 01:48:18,086 - visualization.visualizer - INFO - Created distribution plot for depth_adjusted_comp_pct and saved to ./data\season_2023\visualizations\depth_adjusted_comp_pct_distribution.png
2025-02-28 01:48:18,358 - visualization.visualizer - INFO - Created distribution plot for pressure_performance and saved to ./data\season_2023\visualizations\pressure_performance_distribution.png
2025-02-28 01:48:18,358 - visualization.visualizer - WARNING - Required columns not found for metric vs wins scatter plots
2025-02-28 01:48:18,359 - visualization.visualizer - INFO - Created player_name column for dashboard
2025-02-28 01:48:20,650 - visualization.visualizer - INFO - Created interactive dashboard and saved to ./data\season_2023\visualizations\qb_performance_dashboard.html
2025-02-28 01:48:20,651 - visualization.visualizer - INFO - Successfully created all visualizations
2025-02-28 01:48:20,651 - __main__ - INFO - Visualization completed successfully
2025-02-28 01:48:20,652 - __main__ - INFO - Pipeline completed successfully in 0:00:41.774911
2025-02-28 01:48:44,211 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 01:48:44,211 - __main__ - INFO - Starting data collection step
2025-02-28 01:48:44,212 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 01:48:44,212 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 01:48:44,212 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 01:48:57,073 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 01:48:57,073 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 01:48:58,811 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 01:48:58,812 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 01:49:00,884 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 01:49:00,884 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 01:49:02,285 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 01:49:02,285 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 01:49:05,935 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 01:49:05,936 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 01:49:07,679 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 01:49:07,679 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 01:49:07,680 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 01:49:07,680 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 01:49:11,826 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 01:49:11,838 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 01:49:11,964 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 01:49:11,965 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 01:49:12,024 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 01:49:12,024 - __main__ - INFO - Data collection completed successfully
2025-02-28 01:49:12,026 - __main__ - INFO - Starting data processing step
2025-02-28 01:49:12,026 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 01:49:12,027 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 01:49:12,027 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 01:49:12,027 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 01:49:12,028 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 01:49:12,028 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 01:49:12,028 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 01:49:12,039 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 01:49:12,041 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 01:49:12,137 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 01:49:12,138 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 01:49:12,138 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 01:49:12,138 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 01:49:12,140 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 01:49:12,140 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 01:49:12,148 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 01:49:12,149 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 01:49:12,622 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 01:49:12,625 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 01:49:12,626 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 01:49:12,626 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 01:49:12,626 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 01:49:12,627 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 01:49:12,630 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 01:49:12,631 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 01:49:12,640 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 01:49:12,644 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 01:49:14,528 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 01:49:14,528 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 01:49:14,538 - __main__ - INFO - Data processing completed successfully
2025-02-28 01:49:14,539 - __main__ - INFO - Starting metric development step
2025-02-28 01:49:14,539 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 01:49:14,543 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 01:49:14,546 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 01:49:14,550 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 01:49:14,551 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 01:49:14,554 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 01:49:14,555 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 01:49:14,556 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 01:49:14,556 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 01:49:14,559 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 01:49:14,560 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 01:49:14,560 - __main__ - INFO - Metric development completed successfully
2025-02-28 01:49:14,560 - __main__ - INFO - Starting correlation analysis step
2025-02-28 01:49:14,560 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 01:49:14,560 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 01:49:14,560 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 01:49:14,562 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:49:14,564 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 01:49:14,571 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 01:49:14,846 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 01:49:15,242 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 01:49:15,245 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 01:49:15,249 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 01:49:15,249 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 01:49:15,250 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 01:49:15,250 - __main__ - INFO - Starting visualization step
2025-02-28 01:49:15,250 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 01:49:15,250 - visualization.visualizer - INFO - Created visualization directory: ./data\season_2023\visualizations
2025-02-28 01:49:15,250 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 01:49:16,068 - visualization.visualizer - INFO - Created metric correlation matrix and saved to ./data\season_2023\visualizations\metric_correlation_matrix.png
2025-02-28 01:49:16,341 - visualization.visualizer - INFO - Created distribution plot for qb_composite_score and saved to ./data\season_2023\visualizations\qb_composite_score_distribution.png
2025-02-28 01:49:16,552 - visualization.visualizer - INFO - Created distribution plot for passer_rating and saved to ./data\season_2023\visualizations\passer_rating_distribution.png
2025-02-28 01:49:16,802 - visualization.visualizer - INFO - Created distribution plot for depth_adjusted_comp_pct and saved to ./data\season_2023\visualizations\depth_adjusted_comp_pct_distribution.png
2025-02-28 01:49:17,057 - visualization.visualizer - INFO - Created distribution plot for pressure_performance and saved to ./data\season_2023\visualizations\pressure_performance_distribution.png
2025-02-28 01:49:17,058 - visualization.visualizer - WARNING - Required columns not found for metric vs wins scatter plots
2025-02-28 01:49:17,059 - visualization.visualizer - INFO - Created player_name column for dashboard
2025-02-28 01:49:17,289 - visualization.visualizer - INFO - Created interactive dashboard and saved to ./data\season_2023\visualizations\qb_performance_dashboard.html
2025-02-28 01:49:17,289 - visualization.visualizer - INFO - Successfully created all visualizations
2025-02-28 01:49:17,289 - __main__ - INFO - Visualization completed successfully
2025-02-28 01:49:17,290 - __main__ - INFO - Pipeline completed successfully in 0:00:33.079074
2025-02-28 02:11:26,558 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 02:11:26,558 - __main__ - INFO - Starting data collection step
2025-02-28 02:11:26,559 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 02:11:26,559 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 02:11:26,559 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 02:11:42,811 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 02:11:42,811 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 02:11:45,139 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 02:11:45,140 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 02:11:48,150 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 02:11:48,150 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 02:11:49,960 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 02:11:49,960 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 02:11:53,816 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 02:11:53,817 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 02:11:55,615 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 02:11:55,630 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 02:11:55,631 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 02:11:55,631 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 02:12:04,327 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 02:12:04,352 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 02:12:04,584 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 02:12:04,587 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 02:12:04,691 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 02:12:04,692 - __main__ - INFO - Data collection completed successfully
2025-02-28 02:12:04,692 - __main__ - INFO - Starting data processing step
2025-02-28 02:12:04,693 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 02:12:04,694 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 02:12:04,695 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 02:12:04,695 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 02:12:04,695 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 02:12:04,696 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 02:12:04,696 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 02:12:04,715 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 02:12:04,717 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 02:12:04,835 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 02:12:04,836 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 02:12:04,836 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 02:12:04,837 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 02:12:04,837 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 02:12:04,838 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 02:12:04,851 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 02:12:04,852 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 02:12:05,615 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 02:12:05,620 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 02:12:05,621 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 02:12:05,621 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 02:12:05,622 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 02:12:05,623 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 02:12:05,626 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 02:12:05,628 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 02:12:05,645 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 02:12:05,652 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 02:12:09,034 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 02:12:09,035 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 02:12:09,048 - __main__ - INFO - Data processing completed successfully
2025-02-28 02:12:09,049 - __main__ - INFO - Starting metric development step
2025-02-28 02:12:09,049 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 02:12:09,057 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 02:12:09,064 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 02:12:09,070 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 02:12:09,072 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 02:12:09,077 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 02:12:09,080 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 02:12:09,082 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 02:12:09,082 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 02:12:09,088 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 02:12:09,088 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 02:12:09,089 - __main__ - INFO - Metric development completed successfully
2025-02-28 02:12:09,089 - __main__ - INFO - Starting correlation analysis step
2025-02-28 02:12:09,089 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 02:12:09,090 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 02:12:09,090 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 02:12:09,092 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 02:12:09,094 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 02:12:09,106 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 02:12:09,616 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 02:12:10,305 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 02:12:10,308 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 02:12:10,315 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 02:12:10,315 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 02:12:10,315 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 02:12:10,315 - __main__ - INFO - Starting visualization step
2025-02-28 02:12:10,315 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 02:12:10,316 - visualization.visualizer - INFO - Created visualization directory: ./data\season_2023\visualizations
2025-02-28 02:12:10,316 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 02:12:11,806 - visualization.visualizer - INFO - Created metric correlation matrix and saved to ./data\season_2023\visualizations\metric_correlation_matrix.png
2025-02-28 02:12:12,266 - visualization.visualizer - INFO - Created distribution plot for qb_composite_score and saved to ./data\season_2023\visualizations\qb_composite_score_distribution.png
2025-02-28 02:12:12,623 - visualization.visualizer - INFO - Created distribution plot for passer_rating and saved to ./data\season_2023\visualizations\passer_rating_distribution.png
2025-02-28 02:12:13,188 - visualization.visualizer - INFO - Created distribution plot for depth_adjusted_comp_pct and saved to ./data\season_2023\visualizations\depth_adjusted_comp_pct_distribution.png
2025-02-28 02:12:13,633 - visualization.visualizer - INFO - Created distribution plot for pressure_performance and saved to ./data\season_2023\visualizations\pressure_performance_distribution.png
2025-02-28 02:12:13,634 - visualization.visualizer - WARNING - Required columns not found for metric vs wins scatter plots
2025-02-28 02:12:13,634 - visualization.visualizer - INFO - Created player_name column for dashboard
2025-02-28 02:12:13,997 - visualization.visualizer - INFO - Created interactive dashboard and saved to ./data\season_2023\visualizations\qb_performance_dashboard.html
2025-02-28 02:12:13,998 - visualization.visualizer - INFO - Successfully created all visualizations
2025-02-28 02:12:13,998 - __main__ - INFO - Visualization completed successfully
2025-02-28 02:12:13,998 - __main__ - INFO - Pipeline completed successfully in 0:00:47.440105
2025-02-28 04:10:28,439 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 04:10:28,439 - __main__ - INFO - Starting data collection step
2025-02-28 04:10:28,440 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 04:10:28,440 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 04:10:28,440 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 04:10:53,008 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 04:10:53,009 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 04:10:55,178 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 04:10:55,179 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 04:10:59,442 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 04:10:59,443 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 04:11:01,259 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 04:11:01,260 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 04:11:05,340 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 04:11:05,341 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 04:11:07,181 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 04:11:07,182 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 04:11:07,182 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 04:11:07,182 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 04:11:12,860 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 04:11:12,876 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 04:11:13,047 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 04:11:13,049 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 04:11:13,127 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 04:11:13,128 - __main__ - INFO - Data collection completed successfully
2025-02-28 04:11:13,128 - __main__ - INFO - Starting data processing step
2025-02-28 04:11:13,129 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 04:11:13,130 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 04:11:13,130 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 04:11:13,130 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 04:11:13,131 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 04:11:13,131 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 04:11:13,131 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 04:11:13,144 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 04:11:13,145 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 04:11:13,255 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 04:11:13,256 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 04:11:13,256 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 04:11:13,257 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 04:11:13,257 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 04:11:13,257 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 04:11:13,267 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 04:11:13,267 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 04:11:13,886 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 04:11:13,889 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 04:11:13,891 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 04:11:13,891 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 04:11:13,891 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 04:11:13,892 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 04:11:13,894 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 04:11:13,896 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 04:11:13,908 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 04:11:13,913 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 04:11:16,359 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 04:11:16,359 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 04:11:16,371 - __main__ - INFO - Data processing completed successfully
2025-02-28 04:11:16,372 - __main__ - INFO - Starting metric development step
2025-02-28 04:11:16,372 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 04:11:16,377 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 04:11:16,382 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 04:11:16,388 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 04:11:16,389 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 04:11:16,392 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 04:11:16,394 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 04:11:16,395 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 04:11:16,395 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 04:11:16,399 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 04:11:16,399 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 04:11:16,400 - __main__ - INFO - Metric development completed successfully
2025-02-28 04:11:16,400 - __main__ - INFO - Starting correlation analysis step
2025-02-28 04:11:16,400 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 04:11:16,401 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 04:11:16,401 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 04:11:16,402 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 04:11:16,403 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 04:11:16,411 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 04:11:16,875 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 04:11:17,381 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 04:11:17,384 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 04:11:17,393 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 04:11:17,393 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 04:11:17,393 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 04:11:17,393 - __main__ - INFO - Starting visualization step
2025-02-28 04:11:17,393 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 04:11:17,393 - visualization.visualizer - INFO - Created visualization directory: ./data\season_2023\visualizations
2025-02-28 04:11:17,393 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 04:11:18,459 - visualization.visualizer - INFO - Created metric correlation matrix and saved to ./data\season_2023\visualizations\metric_correlation_matrix.png
2025-02-28 04:11:18,775 - visualization.visualizer - INFO - Created distribution plot for qb_composite_score and saved to ./data\season_2023\visualizations\qb_composite_score_distribution.png
2025-02-28 04:11:19,092 - visualization.visualizer - INFO - Created distribution plot for passer_rating and saved to ./data\season_2023\visualizations\passer_rating_distribution.png
2025-02-28 04:11:19,418 - visualization.visualizer - INFO - Created distribution plot for depth_adjusted_comp_pct and saved to ./data\season_2023\visualizations\depth_adjusted_comp_pct_distribution.png
2025-02-28 04:11:19,737 - visualization.visualizer - INFO - Created distribution plot for pressure_performance and saved to ./data\season_2023\visualizations\pressure_performance_distribution.png
2025-02-28 04:11:19,738 - visualization.visualizer - WARNING - Required columns not found for metric vs wins scatter plots
2025-02-28 04:11:19,738 - visualization.visualizer - INFO - Created player_name column for dashboard
2025-02-28 04:11:19,933 - visualization.visualizer - INFO - Created interactive dashboard and saved to ./data\season_2023\visualizations\qb_performance_dashboard.html
2025-02-28 04:11:19,933 - visualization.visualizer - INFO - Successfully created all visualizations
2025-02-28 04:11:19,934 - __main__ - INFO - Visualization completed successfully
2025-02-28 04:11:19,934 - __main__ - INFO - Pipeline completed successfully in 0:00:51.494992
2025-02-28 10:12:08,847 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 10:12:08,847 - __main__ - INFO - Starting data collection step
2025-02-28 10:12:08,847 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 10:12:08,847 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 10:12:08,847 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 10:12:08,964 - data_collection.data_fetcher - INFO - Successfully fetched 0 play-by-play records
2025-02-28 10:12:08,964 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 10:12:08,977 - data_collection.data_fetcher - ERROR - Error fetching player stats: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:12:08,978 - data_collection.data_fetcher - ERROR - Error fetching comprehensive QB data: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:12:08,978 - __main__ - ERROR - Error in data collection: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:12:08,978 - __main__ - ERROR - Pipeline execution failed: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:12:26,095 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 10:12:26,095 - __main__ - INFO - Starting data collection step
2025-02-28 10:12:26,095 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 10:12:26,095 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 10:12:26,095 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 10:12:47,317 - data_collection.data_fetcher - INFO - Successfully fetched 0 play-by-play records
2025-02-28 10:12:47,317 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 10:13:08,379 - data_collection.data_fetcher - ERROR - Error fetching player stats: <urlopen error [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond>
2025-02-28 10:13:08,379 - data_collection.data_fetcher - ERROR - Error fetching comprehensive QB data: <urlopen error [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond>
2025-02-28 10:13:08,379 - __main__ - ERROR - Error in data collection: <urlopen error [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond>
2025-02-28 10:13:08,379 - __main__ - ERROR - Pipeline execution failed: <urlopen error [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond>
2025-02-28 10:13:30,946 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 10:13:30,947 - __main__ - INFO - Starting data collection step
2025-02-28 10:13:30,947 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 10:13:30,948 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 10:13:30,948 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 10:13:30,998 - data_collection.data_fetcher - INFO - Successfully fetched 0 play-by-play records
2025-02-28 10:13:30,999 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 10:13:31,010 - data_collection.data_fetcher - ERROR - Error fetching player stats: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:13:31,010 - data_collection.data_fetcher - ERROR - Error fetching comprehensive QB data: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:13:31,010 - __main__ - ERROR - Error in data collection: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:13:31,011 - __main__ - ERROR - Pipeline execution failed: <urlopen error [Errno 11001] getaddrinfo failed>
2025-02-28 10:15:15,325 - __main__ - INFO - Starting NFL QB analysis pipeline for 2023 season
2025-02-28 10:15:15,325 - __main__ - INFO - Starting data collection step
2025-02-28 10:15:15,326 - data_collection.data_fetcher - INFO - Initialized NFL data fetcher with data directory: ./data
2025-02-28 10:15:15,326 - data_collection.data_fetcher - INFO - Fetching comprehensive QB data for season 2023
2025-02-28 10:15:15,326 - data_collection.data_fetcher - INFO - Fetching play-by-play data for seasons: [2023]
2025-02-28 10:15:34,981 - data_collection.data_fetcher - INFO - Successfully fetched 49665 play-by-play records
2025-02-28 10:15:34,982 - data_collection.data_fetcher - INFO - Fetching player stats for seasons: [2023]
2025-02-28 10:15:37,028 - data_collection.data_fetcher - INFO - Successfully fetched stats for 588 player records
2025-02-28 10:15:37,029 - data_collection.data_fetcher - INFO - Fetching player information
2025-02-28 10:15:40,456 - data_collection.data_fetcher - INFO - Successfully fetched info for 20754 players
2025-02-28 10:15:40,456 - data_collection.data_fetcher - INFO - Fetching team information
2025-02-28 10:15:42,409 - data_collection.data_fetcher - INFO - Successfully fetched info for 36 teams
2025-02-28 10:15:42,409 - data_collection.data_fetcher - INFO - Fetching team records for seasons: [2023]
2025-02-28 10:15:45,460 - data_collection.data_fetcher - INFO - Added team records from 1 seasons
2025-02-28 10:15:45,460 - data_collection.data_fetcher - INFO - Fetching weekly player stats for seasons: [2023]
2025-02-28 10:15:47,228 - data_collection.data_fetcher - INFO - Successfully fetched 5653 weekly stat records
2025-02-28 10:15:47,228 - data_collection.data_fetcher - INFO - Fetching Next Gen Stats for seasons: [2023]
2025-02-28 10:15:47,229 - data_collection.data_fetcher - ERROR - Error fetching Next Gen Stats: import_ngs_data() got multiple values for argument 'stat_type'
2025-02-28 10:15:47,229 - data_collection.data_fetcher - WARNING - Couldn't fetch NGS data: import_ngs_data() got multiple values for argument 'stat_type', continuing without it
2025-02-28 10:15:51,828 - data_collection.data_fetcher - INFO - Saved play_by_play data to ./data\season_2023\raw\play_by_play.csv
2025-02-28 10:15:51,840 - data_collection.data_fetcher - INFO - Saved player_stats data to ./data\season_2023\raw\player_stats.csv
2025-02-28 10:15:51,974 - data_collection.data_fetcher - INFO - Saved player_info data to ./data\season_2023\raw\player_info.csv
2025-02-28 10:15:51,978 - data_collection.data_fetcher - INFO - Saved team_info data to ./data\season_2023\raw\team_info.csv
2025-02-28 10:15:52,038 - data_collection.data_fetcher - INFO - Saved weekly_stats data to ./data\season_2023\raw\weekly_stats.csv
2025-02-28 10:15:52,038 - __main__ - INFO - Data collection completed successfully
2025-02-28 10:15:52,038 - __main__ - INFO - Starting data processing step
2025-02-28 10:15:52,039 - data_processing.data_processor - INFO - Initialized NFL data processor with data directory: ./data
2025-02-28 10:15:52,040 - data_processing.data_processor - INFO - Processing QB data from: 49665 play-by-play records, 588 player stat records, 20754 player info records, 36 team records
2025-02-28 10:15:52,040 - data_processing.data_processor - INFO - Merging player stats with player info to get position data
2025-02-28 10:15:52,040 - data_processing.data_processor - INFO - Player stats columns: ['player_id', 'season', 'season_type', 'completions', 'attempts', 'passing_yards', 'passing_tds', 'interceptions', 'sacks', 'sack_yards']...
2025-02-28 10:15:52,040 - data_processing.data_processor - INFO - Player info columns: ['birth_date', 'college_conference', 'college_name', 'current_team_id', 'display_name', 'draft_club', 'draft_number', 'draftround', 'entry_year', 'esb_id']...
2025-02-28 10:15:52,041 - data_processing.data_processor - INFO - Player stats sample IDs: ['00-0023459', '00-0024243', '00-0026158']
2025-02-28 10:15:52,041 - data_processing.data_processor - INFO - Using player_id to gsis_id mapping
2025-02-28 10:15:52,055 - data_processing.data_processor - INFO - After merge: 588 records, position nulls: 0
2025-02-28 10:15:52,056 - data_processing.data_processor - INFO - Filtered data to 48 QBs with at least 100 passing attempts
2025-02-28 10:15:52,175 - data_processing.data_processor - INFO - PBP columns related to pressure: ['qb_hit', 'sack', 'lateral_sack_player_id', 'lateral_sack_player_name', 'qb_hit_1_player_id', 'qb_hit_1_player_name', 'qb_hit_2_player_id', 'qb_hit_2_player_name', 'sack_player_id', 'sack_player_name', 'half_sack_1_player_id', 'half_sack_1_player_name', 'half_sack_2_player_id', 'half_sack_2_player_name', 'was_pressure']
2025-02-28 10:15:52,176 - data_processing.data_processor - INFO - Using 'qb_hit' for pressure detection
2025-02-28 10:15:52,177 - data_processing.data_processor - INFO - Using 'sack' for pressure detection
2025-02-28 10:15:52,177 - data_processing.data_processor - INFO - Created 'under_pressure' field using 2 indicators
2025-02-28 10:15:52,178 - data_processing.data_processor - INFO - Prepared 20723 pass plays for QB analysis
2025-02-28 10:15:52,178 - data_processing.data_processor - INFO - Adding team information from player_info
2025-02-28 10:15:52,186 - data_processing.data_processor - INFO - Added team information to 48 QB records
2025-02-28 10:15:52,186 - data_processing.data_processor - INFO - Calculating advanced QB metrics from play-by-play data
2025-02-28 10:15:52,736 - data_processing.data_processor - INFO - Enhanced QB stats with depth-based and pressure metrics for 48 QBs
2025-02-28 10:15:52,739 - data_processing.data_processor - INFO - QB stats already contains a team identifier column
2025-02-28 10:15:52,740 - data_processing.data_processor - INFO - Team mapping sample: [{'team_abbr': 'ARI', 'wins': 4.0, 'losses': 13.0, 'ties': 0.0, 'points_for': 330.0, 'points_against': 455.0}, {'team_abbr': 'ATL', 'wins': 7.0, 'losses': 10.0, 'ties': 0.0, 'points_for': 321.0, 'points_against': 373.0}, {'team_abbr': 'BAL', 'wins': 13.0, 'losses': 4.0, 'ties': 0.0, 'points_for': 483.0, 'points_against': 280.0}, {'team_abbr': 'BUF', 'wins': 11.0, 'losses': 6.0, 'ties': 0.0, 'points_for': 451.0, 'points_against': 311.0}, {'team_abbr': 'CAR', 'wins': 2.0, 'losses': 15.0, 'ties': 0.0, 'points_for': 236.0, 'points_against': 416.0}]
2025-02-28 10:15:52,741 - data_processing.data_processor - WARNING - QB stats missing 'recent_team' column, trying to use 'team' or 'team_abbr' instead
2025-02-28 10:15:52,741 - data_processing.data_processor - INFO - Using 'team_abbr' column instead of 'recent_team'
2025-02-28 10:15:52,744 - data_processing.data_processor - INFO - QB teams: {'TEN': 3, 'SEA': 3, 'CLE': 3, 'LAC': 3, 'LV': 3, 'SF': 2, 'MIN': 2, 'LA': 2, 'PHI': 2, 'BUF': 2, 'CIN': 2, 'JAX': 2, 'PIT': 2, 'CHI': 1, 'NYG': 1, 'CAR': 1, 'GB': 1, 'MIA': 1, 'DEN': 1, 'IND': 1, 'ARI': 1, 'TB': 1, 'BAL': 1, 'KC': 1, 'DET': 1, 'DAL': 1, 'NO': 1, 'ATL': 1, 'NYJ': 1, 'HOU': 1}
2025-02-28 10:15:52,746 - data_processing.data_processor - INFO - Added team context to 48 QB records
2025-02-28 10:15:52,747 - data_processing.data_processor - INFO - Handling 0 missing values across 94 columns
2025-02-28 10:15:52,758 - data_processing.data_processor - INFO - Reduced missing values from 0 to 0
2025-02-28 10:15:52,764 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\qb_analysis_data.csv
2025-02-28 10:15:54,872 - data_processing.data_processor - INFO - Saved processed data to ./data\season_2023\processed\prepared_pbp_data.csv
2025-02-28 10:15:54,872 - data_processing.data_processor - INFO - Successfully processed QB data with 48 records
2025-02-28 10:15:54,884 - __main__ - INFO - Data processing completed successfully
2025-02-28 10:15:54,884 - __main__ - INFO - Starting metric development step
2025-02-28 10:15:54,885 - metric_development.qb_metric - INFO - Initialized QB metric developer with data directory: ./data
2025-02-28 10:15:54,893 - metric_development.qb_metric - INFO - Calculated depth-adjusted accuracy for all QBs
2025-02-28 10:15:54,897 - metric_development.qb_metric - INFO - Calculated pressure performance metric for all QBs
2025-02-28 10:15:54,901 - metric_development.qb_metric - INFO - Calculated mobility contribution metric for all QBs
2025-02-28 10:15:54,902 - metric_development.qb_metric - INFO - Calculated efficiency metrics for all QBs
2025-02-28 10:15:54,906 - metric_development.qb_metric - INFO - Normalized 6 metric components
2025-02-28 10:15:54,908 - metric_development.qb_metric - INFO - Calculated composite QB performance metric for all QBs
2025-02-28 10:15:54,912 - metric_development.qb_metric - INFO - Compared custom QB metric with traditional rating systems
2025-02-28 10:15:54,912 - metric_development.qb_metric - INFO - Identified 0 overrated and 0 underrated QBs
2025-02-28 10:15:54,916 - metric_development.qb_metric - INFO - Saved QB metric results to ./data\season_2023\metrics\qb_composite_metrics.csv
2025-02-28 10:15:54,916 - metric_development.qb_metric - INFO - Successfully developed and calculated QB performance metric
2025-02-28 10:15:54,916 - __main__ - INFO - Metric development completed successfully
2025-02-28 10:15:54,916 - __main__ - INFO - Starting correlation analysis step
2025-02-28 10:15:54,916 - analysis.correlation_analysis - INFO - Initialized QB correlation analyzer with data directory: ./data
2025-02-28 10:15:54,916 - analysis.correlation_analysis - INFO - Created analysis directory: ./data\season_2023\analysis
2025-02-28 10:15:54,917 - analysis.correlation_analysis - INFO - Available numeric columns: ['qb_composite_score', 'passer_rating', 'qbr', 'team_win_pct', 'wins', 'points_for']
2025-02-28 10:15:54,918 - analysis.correlation_analysis - INFO - Column data types before conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 10:15:54,919 - analysis.correlation_analysis - INFO - Column data types after conversion: {'qb_composite_score': dtype('float64'), 'passer_rating': dtype('float64'), 'qbr': dtype('float64'), 'team_win_pct': dtype('float64'), 'wins': dtype('float64'), 'points_for': dtype('float64')}
2025-02-28 10:15:54,929 - analysis.correlation_analysis - INFO - Calculated correlations between QB metrics and team success
2025-02-28 10:15:55,349 - analysis.correlation_analysis - INFO - Created correlation heatmap and saved to ./data\season_2023\analysis\correlation_heatmap.png
2025-02-28 10:15:55,763 - analysis.correlation_analysis - INFO - Created scatter plot and saved to ./data\season_2023\analysis\scatter_qb_composite_score_vs_team_win_pct.png
2025-02-28 10:15:55,765 - analysis.correlation_analysis - INFO - Analyzed differences between custom metric and traditional metrics
2025-02-28 10:15:55,780 - analysis.correlation_analysis - INFO - Generated summary report at ./data\season_2023\analysis\correlation_analysis_report.md
2025-02-28 10:15:55,780 - analysis.correlation_analysis - INFO - Successfully completed correlation analysis
2025-02-28 10:15:55,780 - __main__ - INFO - Correlation analysis completed successfully
2025-02-28 10:15:55,780 - __main__ - INFO - Starting visualization step
2025-02-28 10:15:55,780 - visualization.visualizer - INFO - Initialized QB visualizer with data directory: ./data
2025-02-28 10:15:55,781 - visualization.visualizer - INFO - Created visualization directory: ./data\season_2023\visualizations
2025-02-28 10:15:55,781 - visualization.visualizer - WARNING - Required columns not found for top QBs bar chart
2025-02-28 10:15:56,670 - visualization.visualizer - INFO - Created metric correlation matrix and saved to ./data\season_2023\visualizations\metric_correlation_matrix.png
2025-02-28 10:15:56,947 - visualization.visualizer - INFO - Created distribution plot for qb_composite_score and saved to ./data\season_2023\visualizations\qb_composite_score_distribution.png
2025-02-28 10:15:57,244 - visualization.visualizer - INFO - Created distribution plot for passer_rating and saved to ./data\season_2023\visualizations\passer_rating_distribution.png
2025-02-28 10:15:57,530 - visualization.visualizer - INFO - Created distribution plot for depth_adjusted_comp_pct and saved to ./data\season_2023\visualizations\depth_adjusted_comp_pct_distribution.png
2025-02-28 10:15:57,799 - visualization.visualizer - INFO - Created distribution plot for pressure_performance and saved to ./data\season_2023\visualizations\pressure_performance_distribution.png
2025-02-28 10:15:57,799 - visualization.visualizer - WARNING - Required columns not found for metric vs wins scatter plots
2025-02-28 10:15:57,800 - visualization.visualizer - INFO - Created player_name column for dashboard
2025-02-28 10:15:58,051 - visualization.visualizer - INFO - Created interactive dashboard and saved to ./data\season_2023\visualizations\qb_performance_dashboard.html
2025-02-28 10:15:58,051 - visualization.visualizer - INFO - Successfully created all visualizations
2025-02-28 10:15:58,052 - __main__ - INFO - Visualization completed successfully
2025-02-28 10:15:58,052 - __main__ - INFO - Pipeline completed successfully in 0:00:42.726697
